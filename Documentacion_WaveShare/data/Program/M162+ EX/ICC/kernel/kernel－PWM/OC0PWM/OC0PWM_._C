/*********************************************************************
	微 雪 电 子   WaveShare   http://www.waveShare.net            	
		                                                        
目    的:   建立使用OC0做PWM的示例程序
	
目标系统:   基于AVR单片机
		                                                                
应用软件:   ICCAVR
		                                                                
版    本:   Version 1.0                                                          
		                                                                
圆版时间:   2005-06-25
	
开发人员:   SEE（中文名不告诉你～怕你骂我）

说    明:   若用于商业用途，请保留此段文字或注明代码来源
	
	深 圳 市 微 雪 电 子 有 限 公 司 保 留 所 有 的 版 权     
*********************************************************************/

/*01010101010101010101010101010101010101010101010101010101010101010101
----------------------------------------------------------------------
版本更新记录：
		版    本:   Version 1.1
		圆版时间:   2005-03-25

----------------------------------------------------------------------
接入模块： 
接口说明： 
----------------------------------------------------------------------
注意事项：
		
----------------------------------------------------------------------
10101010101010101010101010101010101010101010101010101010101010101010*/

#include <iom16v.h> 


#define OUT_MOTORL_EN	sbi(DDRB,0)
#define SET_MOTORL_EN	sbi(PORTB,0)
#define CLR_MOTORL_EN	cbi(PORTB,0)

#define OUT_MOTORL_DIR	sbi(DDRB,2)
#define SET_MOTORL_DIR	sbi(PORTB,2)	//motor left turn left
#define CLR_MOTORL_DIR	cbi(PORTB,2)	//motor left turn right

#define OUT_MOTORL_PUL	sbi(DDRB,3)

/*--------------------------------------------------------------------
函数名称：
函数功能：
注意事项：
提示说明：
输    入：
返    回：
--------------------------------------------------------------------*/
void timer0_init(void) 
{ 
	TCCR0 = (1<<WGM01)|(1<<WGM00)|(1<<COM01)|(1<<COM00)|(1<<CS00);	
/*
	WGM01=1; WGM00=1; --> fast PWM modle
	COM01=1; COM00=0; --> 比较匹配时set OC0 pin
	CS00=1;  --> timer0 source 不经过任何分频，直接为Clk，使得PWM可以工作得足够快
*/
	TCNT0 = 0x00;			//设置TC0计数寄存器初值 
	OCR0  = 0xe0;			//输出比较寄存器初值，设置该值可用于调节占空比
} 
/*--------------------------------------------------------------------
函数名称：
函数功能：
注意事项：
提示说明：
输    入：
返    回：
--------------------------------------------------------------------*/
void main(void) 
{
	OUT_MOTORL_EN;				
	OUT_MOTORL_DIR;
	OUT_MOTORL_PUL;
	SET_MOTORL_EN;
	timer0_init(); 
	SEI(); 
	while(1);
}


